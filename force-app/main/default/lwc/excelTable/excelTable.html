<template>
      <table style="width:100%" oncontextmenu={handleContextMenu} onkeypress={handleKeyPress} oncopy={handleCopy} onpaste={handlePaste}>
        <tr>
          <th if:true={showRowNumberColumn}></th>
          <template for:each={columns} for:item="column">
            <th key={column.fieldName} class="column-label">{column.label}</th>
          </template>
        </tr>
        <template for:each={records} for:item="record" for:index="rowIndex"> 
          <tr key={record}>
            <td class="row-number" if:true={showRowNumberColumn} key={record}>
              {rowIndex}
            </td>
            <template for:each={record.fields} for:item="field" for:index="columnIndex">
              <td key={field.fieldName} data-row={rowIndex} data-column={columnIndex} ondblclick={handleDoubleClick} onmouseover={handleOver} onmouseup={handleUp} onmousedown={handleDown}>
                <input type='text' value={field.value} ondblclick={handleDoubleClick} onfocusout={handleFocusOut} onchange={handleCellValueChange} disabled/>
              </td>
            </template>
          </tr>
        </template>
      </table> 

      <div id="context-menu" class="menu-context">
          <template for:each={contextMenuItems} for:item="contextMenuItem">
              <lightning-button key={contextMenuItem.action} variant="base" label={contextMenuItem.label} icon-name={contextMenuItem.icon} data-action={contextMenuItem.action} onclick={contextMenuItem.actionHandler}></lightning-button>
          </template>
      </div>

      <div class="copy-border"></div>
</template>